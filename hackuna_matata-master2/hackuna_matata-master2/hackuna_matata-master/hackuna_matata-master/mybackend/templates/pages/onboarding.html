<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UniKart - Welcome</title>
    <link rel="stylesheet" href="../css/global.css">
    <style>
        /* Onboarding Styles */
        .onboarding-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 2rem 1rem;
        }

        .welcome-animated {
            min-height: auto;
            max-width: 900px;
            width: 90%;
            margin: auto;
            background: #fff;
            border-radius: 36px;
            box-shadow: 0 12px 64px 8px rgba(227, 28, 28, 0.13), 0 1.5px 4px rgba(195, 195, 196, 0.27);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-align: center;
            padding: 3rem 4rem;
            user-select: none;
            opacity: 0;
            filter: blur(24px);
            transform: translateY(20px);
            animation: slideIn 1.2s ease-out forwards;
        }

        @keyframes slideIn {
            to {
                opacity: 1;
                filter: blur(0);
                transform: translateY(0);
            }
        }

        /* Step Content */
        .step-content {
            display: none;
            opacity: 0;
            transform: translateX(20px);
            transition: all 0.4s ease-out;
        }

        .step-content.active {
            display: block;
            opacity: 1;
            transform: translateX(0);
        }

        /* Welcome Step */
        .welcome-title {
            font-size: 46px;
            font-weight: 900;
            margin-bottom: 24px;
            letter-spacing: 1.5px;
            color: #18181a;
            line-height: 1.08;
            padding: 0 2rem;
            animation: titleScale 1s ease-out 0.3s both;
        }

        @keyframes titleScale {
            from { transform: scale(0.7); }
            to { transform: scale(1); }
        }

        .brand-highlight { color: #e31c1c; }

        .welcome-desc {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 48px;
            color: #252527;
            opacity: 0.92;
            max-width: 460px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.4;
            padding: 0 2rem;
        }

        .welcome-btn {
            border: none;
            border-radius: 42px;
            padding: 16px 48px;
            font-weight: 900;
            font-size: 20px;
            color: #fff;
            background: #e31c1c;
            cursor: pointer;
            box-shadow: 0 6px 28px rgba(227, 28, 28, 0.27);
            text-transform: uppercase;
            letter-spacing: 2px;
            min-width: 180px;
            transition: all 0.3s ease;
            animation: buttonSlideUp 0.6s ease-out 0.5s both;
        }

        @keyframes buttonSlideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .welcome-btn:hover {
            transform: scale(1.1);
            background: #bf1414;
        }

        .welcome-btn:active { transform: scale(0.95); }

        /* Profile Step */
        .profile-title {
            margin-bottom: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 28px;
            font-weight: 900;
            color: #18181a;
        }

        .profile-pic-container {
            cursor: pointer;
            display: inline-block;
            margin-bottom: 16px;
        }

        .profile-pic-placeholder {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            background: #f2f2f2;
            color: #c81313;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2.5px dashed rgba(227, 28, 28, 0.4);
            font-size: 40px;
            margin-bottom: 12px;
            transition: all 0.3s ease;
        }

        .profile-pic-placeholder:hover {
            border-color: #e31c1c;
            background: #fafafa;
        }

        .profile-pic-preview {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            box-shadow: 0 10px 40px rgba(227, 28, 28, 0.24);
            object-fit: cover;
            margin-bottom: 12px;
        }

        .upload-text {
            font-size: 16px;
            font-weight: 700;
            color: #e31c1c;
            display: block;
            margin-top: 8px;
        }

        .profile-note {
            font-size: 14px;
            font-weight: 600;
            color: #e31c1c;
            margin-bottom: 28px;
        }

        .bio-input {
            font-size: 18px;
            padding: 12px;
            width: 100%;
            border-radius: 20px;
            border: 2px solid #e31c1c;
            resize: none;
            box-shadow: inset 0 2px 8px #eee;
            margin-bottom: 24px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            box-sizing: border-box;
            transition: all 0.3s ease;
        }

        .bio-input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(227, 28, 28, 0.1), inset 0 2px 8px #eee;
        }

        /* Course Step */
        .course-title {
            margin-bottom: 24px;
            font-size: 28px;
            font-weight: 900;
            color: #18181a;
        }

        .form-group {
            text-align: left;
            margin-bottom: 20px;
        }

        .form-label {
            font-weight: 600;
            color: #e31c1c;
            font-size: 18px;
            display: block;
            margin-bottom: 8px;
        }

        .required { color: #cc0000; }

        .form-select, .form-input {
            width: 100%;
            font-size: 18px;
            padding: 14px;
            border-radius: 14px;
            border: 2px solid #e31c1c;
            box-sizing: border-box;
            transition: all 0.3s ease;
        }

        .form-select:focus, .form-input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(227, 28, 28, 0.1);
        }

        /* Chips */
        .chips-container {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
            margin-top: 12px;
        }

        .chip {
            padding: 10px 24px;
            border-radius: 48px;
            border: 2.5px solid #bbb;
            background-color: #fff;
            color: #333;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            user-select: none;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .chip:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .chip:active {
            transform: scale(0.95);
        }

        .chip.selected {
            border: 3px solid #e31c1c;
            background-color: rgba(227, 28, 28, 0.27);
            color: #e31c1c;
            box-shadow: 0 6px 12px rgba(227, 28, 28, 0.45);
            animation: chipSelect 0.3s ease;
        }

        @keyframes chipSelect {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1.05); }
        }

        /* Buttons */
        .step-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .btn-primary, .btn-secondary, .btn-finish {
            border-radius: 32px;
            padding: 15px 40px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: all 0.3s ease;
            border: none;
        }

        .btn-primary {
            color: white;
            background-color: #e31c1c;
        }

        .btn-primary:hover {
            background-color: #c61616;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(227, 28, 28, 0.3);
        }

        .btn-secondary {
            color: #e31c1c;
            background-color: white;
            border: 3px solid #e31c1c;
        }

        .btn-secondary:hover {
            background-color: #e31c1c;
            color: white;
        }

        .btn-finish {
            flex: 1;
            min-width: 200px;
            background-color: #e31c1c;
            color: white;
            font-weight: 900;
            font-size: 20px;
            border-radius: 48px;
            padding: 16px;
            letter-spacing: 3px;
        }

        .btn-finish:disabled {
            background-color: #ddd;
            color: #aaa;
            cursor: not-allowed;
        }

        .btn-finish:not(:disabled):hover {
            background-color: #c61616;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(227, 28, 28, 0.4);
        }

        .btn-back {
            margin-top: 16px;
            background-color: transparent;
            border: none;
            color: #e31c1c;
            font-size: 14px;
            cursor: pointer;
            text-decoration: underline;
        }

        .btn-back:hover { color: #c61616; }

        /* Responsive */
        @media (max-width: 600px) {
            .welcome-animated {
                padding: 2rem 1.5rem;
                border-radius: 24px;
            }
            .welcome-title {
                font-size: 36px;
                padding: 0 1rem;
            }
            .chips-container { justify-content: flex-start; }
            .chip { font-size: 14px; padding: 8px 16px; }
            .step-buttons { flex-direction: column; align-items: center; }
            .btn-primary, .btn-secondary, .btn-finish { width: 100%; max-width: 300px; }
        }
    </style>
</head>
<body>
    <div class="onboarding-container">
        <div class="welcome-animated" id="onboardingCard">
            
            <!-- Step 0: Welcome -->
            <div class="step-content active" id="step-0">
                <h1 class="welcome-title">
                    Hi <span id="usernameDisplay">User</span>,<br />
                    Welcome to <span class="brand-highlight">UniKart!</span>
                </h1>
                <p class="welcome-desc">
                    Let's set up your profile to personalize your experience.
                </p>
                <button class="welcome-btn" onclick="nextStep()">
                    Get Started
                </button>
            </div>

            <!-- Step 1: Profile Setup -->
            <div class="step-content" id="step-1">
                <h2 class="profile-title">
                    <span>ðŸ‘¤</span> Set Up Your Profile
                </h2>

                <label class="profile-pic-container" onclick="document.getElementById('pfp-upload').click()">
                    <div class="profile-pic-placeholder" id="profilePicPlaceholder">
                        ðŸ“·
                    </div>
                    <img id="profilePicPreview" class="profile-pic-preview" style="display: none;" />
                    <div class="upload-text">Upload photo</div>
                </label>
                <input id="pfp-upload" type="file" accept="image/*" style="display: none;" onchange="handleImageUpload(this)"/>

                <p class="profile-note">Profile picture recommended!</p>

                <textarea 
                    id="bioInput" 
                    class="bio-input" 
                    placeholder="Your bio or about you (can skip)" 
                    rows="5"
                ></textarea>

                <div class="step-buttons">
                    <button class="btn-primary" onclick="nextStep()">Continue</button>
                    <button class="btn-secondary" onclick="nextStep()">Skip Bio</button>
                </div>
            </div>

            <!-- Step 2: Course & Interests -->
            <div class="step-content" id="step-2">
                <h2 class="course-title">Let's complete your profile!</h2>

                <div class="form-group">
                    <label class="form-label">
                        Your Course <span class="required">*</span>
                    </label>
                    <select id="courseSelect" class="form-select" onchange="updateFinishButton()">
                        <option value="" disabled selected>Select your course</option>
                        <option value="BTech">BTech</option>
                        <option value="MBA">MBA</option>
                        <option value="BSc">BSc</option>
                        <option value="BA">BA</option>
                        <option value="MTech">MTech</option>
                        <option value="MSc">MSc</option>
                        <option value="Other">Other</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Specialization (if any)</label>
                    <input 
                        type="text" 
                        id="specializationInput" 
                        class="form-input" 
                        placeholder="E.g. Computer Science, Finance, Design"
                    />
                </div>

                <div class="form-group">
                    <label class="form-label">Skills (select multiple)</label>
                    <div class="chips-container" id="skillsContainer">
                        <button type="button" class="chip" onclick="toggleChip(this, 'skills')">Programming</button>
                        <button type="button" class="chip" onclick="toggleChip(this, 'skills')">UI/UX</button>
                        <button type="button" class="chip" onclick="toggleChip(this, 'skills')">Public Speaking</button>
                        <button type="button" class="chip" onclick="toggleChip(this, 'skills')">Leadership</button>
                        <button type="button" class="chip" onclick="toggleChip(this, 'skills')">Data Analysis</button>
                        <button type="button" class="chip" onclick="toggleChip(this, 'skills')">Design</button>
                        <button type="button" class="chip" onclick="toggleChip(this, 'skills')">Writing</button>
                        <button type="button" class="chip" onclick="toggleChip(this, 'skills')">Marketing</button>
                        <button type="button" class="chip" onclick="toggleChip(this, 'skills')">Photography</button>
                        <button type="button" class="chip" onclick="toggleChip(this, 'skills')">Other</button>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Interests (select multiple)</label>
                    <div class="chips-container" id="interestsContainer">
                        <button type="button" class="chip" onclick="toggleChip(this, 'interests')">Sports</button>
                        <button type="button" class="chip" onclick="toggleChip(this, 'interests')">Coding</button>
                        <button type="button" class="chip" onclick="toggleChip(this, 'interests')">Music</button>
                        <button type="button" class="chip" onclick="toggleChip(this, 'interests')">Gaming</button>
                        <button type="button" class="chip" onclick="toggleChip(this, 'interests')">Travel</button>
                        <button type="button" class="chip" onclick="toggleChip(this, 'interests')">Art</button>
                        <button type="button" class="chip" onclick="toggleChip(this, 'interests')">AI</button>
                        <button type="button" class="chip" onclick="toggleChip(this, 'interests')">Reading</button>
                        <button type="button" class="chip" onclick="toggleChip(this, 'interests')">Photography</button>
                        <button type="button" class="chip" onclick="toggleChip(this, 'interests')">Other</button>
                    </div>
                </div>

                <div class="step-buttons" style="margin-top: 42px;">
                    <button class="btn-finish" id="finishBtn" onclick="finishOnboarding()" disabled>
                        Finish Setup
                    </button>
                </div>

                <button class="btn-back" onclick="prevStep()">Back</button>
            </div>

        </div>
    </div>

    <script>
        // Onboarding state
        let currentStep = 0;
        let profileData = {
            profilePic: null,
            bio: '',
            course: '',
            specialization: '',
            skills: [],
            interests: []
        };

        // Initialize onboarding
        window.addEventListener('DOMContentLoaded', function() {
            // Load username
            const savedUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
            if (savedUser.name) {
                document.getElementById('usernameDisplay').textContent = savedUser.name;
            }

            // Show first step with animation delay
            setTimeout(() => {
                document.getElementById('step-0').classList.add('active');
            }, 500);
        });

        // Navigation functions
        function nextStep() {
            if (currentStep < 2) {
                // Collect current step data
                collectCurrentStepData();
                
                // Hide current step
                const currentStepEl = document.getElementById(`step-${currentStep}`);
                currentStepEl.classList.remove('active');
                
                // Show next step
                setTimeout(() => {
                    currentStep++;
                    const nextStepEl = document.getElementById(`step-${currentStep}`);
                    nextStepEl.classList.add('active');
                    
                    // Update finish button if we're on step 2
                    if (currentStep === 2) {
                        updateFinishButton();
                    }
                }, 200);
            }
        }

        function prevStep() {
            if (currentStep > 0) {
                // Hide current step
                const currentStepEl = document.getElementById(`step-${currentStep}`);
                currentStepEl.classList.remove('active');
                
                // Show previous step
                setTimeout(() => {
                    currentStep--;
                    const prevStepEl = document.getElementById(`step-${currentStep}`);
                    prevStepEl.classList.add('active');
                }, 200);
            }
        }

        // Image upload handling
        function handleImageUpload(input) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const placeholder = document.getElementById('profilePicPlaceholder');
                    const preview = document.getElementById('profilePicPreview');
                    
                    placeholder.style.display = 'none';
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                    
                    // Store the image data
                    profileData.profilePic = e.target.result;
                    
                    // Animation
                    preview.style.transform = 'scale(0.8)';
                    setTimeout(() => {
                        preview.style.transform = 'scale(1)';
                    }, 50);
                };
                reader.readAsDataURL(file);
            }
        }

        // Chip toggle functionality
        function toggleChip(chip, type) {
            const value = chip.textContent;
            const isSelected = chip.classList.contains('selected');
            
            if (isSelected) {
                chip.classList.remove('selected');
                profileData[type] = profileData[type].filter(item => item !== value);
            } else {
                chip.classList.add('selected');
                if (!profileData[type].includes(value)) {
                    profileData[type].push(value);
                }
            }
            
            // Animation feedback
            chip.style.transform = 'scale(0.95)';
            setTimeout(() => {
                chip.style.transform = '';
            }, 150);
        }

        // Collect step data
        function collectCurrentStepData() {
            if (currentStep === 1) {
                // Collect bio
                const bioInput = document.getElementById('bioInput');
                profileData.bio = bioInput.value;
            } else if (currentStep === 2) {
                // Collect course and specialization
                const courseSelect = document.getElementById('courseSelect');
                const specializationInput = document.getElementById('specializationInput');
                profileData.course = courseSelect.value;
                profileData.specialization = specializationInput.value;
            }
        }

        // Update finish button state
        function updateFinishButton() {
            const finishBtn = document.getElementById('finishBtn');
            const courseSelect = document.getElementById('courseSelect');
            
            if (courseSelect.value) {
                finishBtn.disabled = false;
                finishBtn.style.backgroundColor = '#e31c1c';
                finishBtn.style.color = 'white';
                finishBtn.style.cursor = 'pointer';
            } else {
                finishBtn.disabled = true;
                finishBtn.style.backgroundColor = '#ddd';
                finishBtn.style.color = '#aaa';
                finishBtn.style.cursor = 'not-allowed';
            }
        }

        // Finish onboarding
        function finishOnboarding() {
            const finishBtn = document.getElementById('finishBtn');
            
            // Validate course selection
            if (!document.getElementById('courseSelect').value) {
                finishBtn.innerHTML = 'Please select a course!';
                finishBtn.style.backgroundColor = '#dc3545';
                setTimeout(() => {
                    finishBtn.innerHTML = 'Finish Setup';
                    updateFinishButton();
                }, 2000);
                return;
            }
            
            // Collect final data
            collectCurrentStepData();
            
            // Show loading
            finishBtn.innerHTML = 'Setting up your profile...';
            finishBtn.disabled = true;
            finishBtn.style.opacity = '0.7';
            
            // Save profile data
            const existingUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
            const completeProfile = {
                ...existingUser,
                ...profileData,
                onboardingCompleted: true
            };
            
            localStorage.setItem('currentUser', JSON.stringify(completeProfile));
            localStorage.setItem('userProfile', JSON.stringify(profileData));
            
            // Redirect to home after delay
            setTimeout(() => {
                window.location.href = 'home.html';
            }, 2000);
        }
    </script>
</body>
</html>
